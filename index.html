<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>自动答题助手 - 带Base64解密的网页自动答题工具</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        :root {
            --primary: #2196F3;
            --primary-dark: #0D47A1;
            --success: #4CAF50;
            --warning: #FF9800;
            --danger: #e53e3e;
            --light: #f5f7fa;
            --dark: #1e1e2f;
            --gray: #718096;
            --gray-light: #e2e8f0;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.15);
            --radius: 8px;
            --transition: all 0.3s ease;
        }
        body {
            background-color: #f9fafb;
            color: var(--dark);
            line-height: 1.6;
        }
        a {
            text-decoration: none;
            color: var(--primary);
            transition: var(--transition);
        }
        a:hover {
            color: var(--primary-dark);
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        /* 导航栏 */
        header {
            background-color: #fff;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 999;
        }
        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            font-size: 20px;
            color: var(--primary-dark);
        }
        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 18px;
        }
        .nav-links {
            display: flex;
            gap: 30px;
        }
        .nav-links a {
            font-weight: 500;
            font-size: 16px;
        }
        .hamburger {
            display: none;
            font-size: 24px;
            color: var(--dark);
            cursor: pointer;
        }
        /* 英雄区 */
        .hero {
            padding: 80px 0;
            text-align: center;
            background: linear-gradient(135deg, #f0f8fb 0%, #e6f7ff 100%);
            margin-bottom: 60px;
            border-radius: 0 0 50px 50px;
        }
        .hero h1 {
            font-size: 36px;
            margin-bottom: 20px;
            color: var(--primary-dark);
            line-height: 1.3;
        }
        .hero p {
            font-size: 18px;
            color: var(--gray);
            max-width: 800px;
            margin: 0 auto 40px;
        }
        .btn {
            display: inline-block;
            padding: 12px 30px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: #fff;
            border-radius: var(--radius);
            font-weight: 600;
            font-size: 16px;
            border: none;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            color: #fff;
        }
        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
            margin-left: 20px;
        }
        .btn-outline:hover {
            background: var(--primary);
            color: #fff;
        }
        /* 功能亮点 */
        .section {
            padding: 60px 0;
        }
        .section-title {
            text-align: center;
            font-size: 30px;
            margin-bottom: 60px;
            color: var(--primary-dark);
            position: relative;
        }
        .section-title::after {
            content: "";
            width: 80px;
            height: 4px;
            background: var(--primary);
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 2px;
        }
        .features {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
        }
        .feature-card {
            background: #fff;
            padding: 30px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            transition: var(--transition);
            height: 100%;
        }
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        .feature-icon {
            width: 60px;
            height: 60px;
            background: rgba(33, 150, 243, 0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-size: 24px;
        }
        .feature-card h3 {
            font-size: 20px;
            margin-bottom: 15px;
            color: var(--dark);
        }
        .feature-card p {
            color: var(--gray);
            font-size: 14px;
        }
        /* 使用教程 */
        .tutorial {
            background: #fff;
            padding: 60px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            max-width: 1000px;
            margin: 0 auto;
        }
        .tutorial-step {
            margin-bottom: 40px;
        }
        .tutorial-step:last-child {
            margin-bottom: 0;
        }
        .tutorial-step h4 {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--primary-dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .tutorial-step h4 span {
            width: 30px;
            height: 30px;
            background: var(--primary);
            color: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }
        .tutorial-step p {
            color: var(--gray);
            margin-left: 40px;
        }
        /* 代码获取 */
        .code-section {
            background: var(--dark);
            color: #fff;
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow-lg);
            margin: 0 auto;
            max-width: 1100px;
        }
        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #333;
        }
        .code-header h3 {
            font-size: 18px;
            color: var(--primary);
        }
        #copy-btn {
            background: var(--primary);
            color: #fff;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
        }
        #copy-btn:hover {
            background: var(--primary-dark);
        }
        .code-box {
            background: #121212;
            padding: 20px;
            border-radius: 4px;
            overflow-x: auto;
            font-family: "Consolas", "Monaco", monospace;
            font-size: 14px;
            line-height: 1.5;
            color: #ccc;
            max-height: 600px;
        }
        /* 注意事项 */
        .notice {
            background: rgba(255, 152, 0, 0.1);
            border-left: 4px solid var(--warning);
            padding: 20px;
            margin: 30px auto 0;
            max-width: 1000px;
            border-radius: 0 var(--radius) var(--radius) 0;
        }
        .notice h4 {
            color: var(--warning);
            margin-bottom: 10px;
            font-size: 16px;
        }
        .notice p {
            color: var(--dark);
            font-size: 14px;
            margin-bottom: 8px;
        }
        .notice p:last-child {
            margin-bottom: 0;
        }
        /* 页脚 */
        footer {
            background: var(--dark);
            color: #ccc;
            padding: 50px 0 20px;
            margin-top: 80px;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 40px;
        }
        .footer-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            font-size: 20px;
            color: #fff;
            margin-bottom: 20px;
        }
        .footer-logo .logo-icon {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
        }
        .footer-desc {
            max-width: 400px;
            font-size: 14px;
            line-height: 1.6;
        }
        .footer-links h4 {
            color: #fff;
            font-size: 18px;
            margin-bottom: 20px;
        }
        .footer-links ul {
            list-style: none;
        }
        .footer-links ul li {
            margin-bottom: 10px;
        }
        .footer-links ul li a {
            color: #ccc;
        }
        .footer-links ul li a:hover {
            color: var(--primary);
        }
        .copyright {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid #333;
            font-size: 14px;
        }
        /* 响应式适配 */
        @media (max-width: 992px) {
            .features {
                grid-template-columns: repeat(2, 1fr);
            }
            .hero h1 {
                font-size: 30px;
            }
            .section-title {
                font-size: 26px;
            }
        }
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            .hamburger {
                display: block;
            }
            .hero {
                padding: 60px 0;
            }
            .hero h1 {
                font-size: 24px;
            }
            .hero p {
                font-size: 16px;
            }
            .btn {
                padding: 10px 20px;
                font-size: 14px;
            }
            .features {
                grid-template-columns: 1fr;
            }
            .section {
                padding: 40px 0;
            }
            .section-title {
                font-size: 22px;
                margin-bottom: 40px;
            }
            .tutorial {
                padding: 30px 20px;
            }
            .tutorial-step p {
                margin-left: 0;
            }
            .footer-content {
                flex-direction: column;
            }
            .code-box {
                max-height: 400px;
            }
        }
        @media (max-width: 576px) {
            .hero .btn-group {
                display: flex;
                flex-direction: column;
                gap: 15px;
                align-items: center;
            }
            .btn-outline {
                margin-left: 0;
                width: 100%;
                max-width: 200px;
                text-align: center;
            }
            .code-section {
                padding: 20px;
            }
            .code-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            #copy-btn {
                width: 100%;
            }
        }
    </style>
    <script src="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
</head>
<body>
    <!-- 导航栏 -->
    <header>
        <div class="container nav">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-robot"></i>
                </div>
                自动答题助手
            </div>
            <div class="nav-links">
                <a href="#features">功能亮点</a>
                <a href="#tutorial">使用教程</a>
                <a href="#code">获取代码</a>
                <a href="#notice">注意事项</a>
            </div>
            <div class="hamburger">
                <i class="fas fa-bars"></i>
            </div>
        </div>
    </header>
    <!-- 英雄区 -->
    <section class="hero">
        <div class="container">
            <h1>网页自动答题助手 · 带Base64解密功能</h1>
            <p>纯原生JS开发，无需安装插件，支持自动识别输入框、填充答案、自动提交、Base64解密，适配各类网页答题场景，可拖拽缩放面板，操作简单高效</p>
            <div class="btn-group">
                <a href="#code" class="btn"><i class="fas fa-code"></i> 立即获取代码</a>
                <a href="#tutorial" class="btn btn-outline"><i class="fas fa-book"></i> 查看使用教程</a>
            </div>
        </div>
    </section>
    <!-- 功能亮点 -->
    <section class="section container" id="features">
        <h2 class="section-title">核心功能亮点</h2>
        <div class="features">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-unlock"></i>
                </div>
                <h3>Base64自动解密</h3>
                <p>自动识别Base64格式的题目/答案，一键解密，支持中文、特殊字符解密，解密失败自动返回原内容，兼容性强</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-mouse-pointer"></i>
                </div>
                <h3>可视化控制面板</h3>
                <p>可拖拽、缩放、最小化面板，支持夜间模式、置顶锁定、透明度调节，实时展示答题进度，操作状态可视化</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-magic"></i>
                </div>
                <h3>自动识别提交</h3>
                <p>智能识别网页可输入元素，模拟键盘输入答案，支持回车/提交按钮双方式提交，失败自动重试，可配置重试次数</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-plug"></i>
                </div>
                <h3>接口自动拦截</h3>
                <p>自动拦截网页API请求，解析答题题库数据，无需手动导入，题库加载后自动解密，一键开始答题</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-keyboard"></i>
                </div>
                <h3>快捷按键操作</h3>
                <p>支持Alt+V显隐面板、Alt+A启停答题、Alt+N下一题、Alt+R重置位置，无需鼠标，操作更高效</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-save"></i>
                </div>
                <h3>本地配置保存</h3>
                <p>面板位置、尺寸、主题、延迟、重试次数等配置自动保存到本地，刷新页面不丢失，下次使用直接复用</p>
            </div>
        </div>
    </section>
    <!-- 使用教程 -->
    <section class="section container" id="tutorial">
        <h2 class="section-title">快速使用教程</h2>
        <div class="tutorial">
            <div class="tutorial-step">
                <h4><span>1</span>打开答题网页并准备工具</h4>
                <p>打开需要答题的网页，确保答题界面已加载完成，同时在本网站复制【自动答题助手】完整代码</p>
            </div>
            <div class="tutorial-step">
                <h4><span>2</span>打开浏览器开发者工具</h4>
                <p>在答题网页中，按键盘F12键打开浏览器开发者工具，切换到「Console（控制台）」面板</p>
            </div>
            <div class="tutorial-step">
                <h4><span>3</span>粘贴代码并执行</h4>
                <p>将复制的助手代码粘贴到控制台输入框中，按回车键执行，页面会自动生成可视化控制面板</p>
            </div>
            <div class="tutorial-step">
                <h4><span>4</span>配置工具并启用解密</h4>
                <p>在控制面板中，开启「Base64解密」开关，配置答题延迟、最大重试次数，面板可拖拽到任意位置</p>
            </div>
            <div class="tutorial-step">
                <h4><span>5</span>开始自动答题</h4>
                <p>点击面板中的「自动答题」按钮，工具会自动拦截题库、解密内容、填充答案并提交，实时展示答题进度</p>
            </div>
        </div>
    </section>
    <!-- 代码获取 -->
    <section class="section container" id="code">
        <h2 class="section-title">获取完整代码</h2>
        <div class="code-section">
            <div class="code-header">
                <h3>自动答题助手（带Base64解密）- 纯原生JS代码</h3>
                <button id="copy-btn"><i class="fas fa-copy"></i> 一键复制代码</button>
            </div>
            <div class="code-box" id="code-content">
(function() {
    'use strict';
    // 核心配置项
    const CONFIG = {
        defaultDelay: 500,
        version: '1.2.0',
        panelBaseSize: 360,
        panelMinSize: 300,
        panelMaxSize: 500,
        inputSelectors: [
            'input[type="text"]:not([disabled])',
            'textarea:not([disabled])',
            'input:not([type="hidden"]):not([type="password"]):not([disabled])',
            '[contenteditable="true"]:not([disabled])'
        ],
        submitKeywords: ['提交', 'submit', '确认', 'next', '检查', 'check', '下一步', '继续'],
        retryInterval: 300,
        maxRetry: 5,
        storageKey: 'autoAnswerHelper_v1.2.0',
        theme: {
            light: {
                panelBg: 'rgba(255, 255, 255, 0.98)',
                border: '#2196F3',
                text: '#2d3748',
                lightText: '#718096',
                cardBg: '#f0f8fb',
                success: '#4CAF50',
                warning: '#FF9800',
                danger: '#e53e3e',
                highlight: '#2196F3'
            },
            dark: {
                panelBg: 'rgba(30, 30, 40, 0.98)',
                border: '#444',
                text: '#e0e0e0',
                lightText: '#aaa',
                cardBg: 'rgba(40, 40, 50, 0.8)',
                highlight: '#64B5F6',
                success: '#4CAF50',
                warning: '#FF9800',
                danger: '#ef5350'
            }
        }
    };

    // 全局状态
    let state = {
        isRunning: false,
        currentTheme: 'light',
        panelPos: { x: 20, y: 20 },
        panelSize: { w: CONFIG.panelBaseSize, h: 400 },
        panelOpacity: 0.98,
        isFixed: true,
        delay: CONFIG.defaultDelay,
        maxRetry: CONFIG.maxRetry,
        enableBase64: true,
        questionBank: {},
        currentAnswer: ''
    };

    // 加载本地配置
    function loadLocalConfig() {
        try {
            const saved = localStorage.getItem(CONFIG.storageKey);
            if (saved) Object.assign(state, JSON.parse(saved));
        } catch (e) {
            console.log('加载配置失败，使用默认配置', e);
        }
    }

    // 保存本地配置
    function saveLocalConfig() {
        try {
            localStorage.setItem(CONFIG.storageKey, JSON.stringify({
                currentTheme,
                panelPos,
                panelSize,
                panelOpacity,
                isFixed,
                delay,
                maxRetry,
                enableBase64
            }));
        } catch (e) {
            console.log('保存配置失败', e);
        }
    }

    // Base64解密核心方法（支持中文/特殊字符）
    function base64Decode(str) {
        if (!state.enableBase64) return str;
        try {
            // 处理URL安全的Base64
            str = str.replace(/-/g, '+').replace(/_/g, '/');
            // 补全等号
            while (str.length % 4) str += '=';
            // 浏览器原生解密+中文转码
            return decodeURIComponent(escape(atob(str)));
        } catch (e) {
            console.log('Base64解密失败，返回原内容', e);
            return str;
        }
    }

    // Base64检测
    function isBase64(str) {
        if (!str || str.length < 4) return false;
        try {
            const testStr = str.replace(/-/g, '+').replace(/_/g, '/');
            while (testStr.length % 4) testStr += '=';
            atob(testStr);
            return true;
        } catch (e) {
            return false;
        }
    }

    // 拦截API请求，解析题库
    function interceptApiRequest() {
        const originalFetch = window.fetch;
        window.fetch = async function(url, options) {
            const response = await originalFetch.apply(this, arguments);
            // 克隆响应体，避免被消耗
            const clone = response.clone();
            try {
                const data = await clone.json();
                // 解析题库（适配常见的返回格式）
                parseQuestionBank(data);
            } catch (e) {
                try {
                    const text = await clone.text();
                    if (text.includes('question') || text.includes('answer')) {
                        parseQuestionBank(JSON.parse(text));
                    }
                } catch (e2) { /* 忽略非JSON格式 */ }
            }
            return response;
        };

        // 拦截XHR请求
        const originalXhrOpen = XMLHttpRequest.prototype.open;
        XMLHttpRequest.prototype.open = function(method, url) {
            this.addEventListener('load', function() {
                try {
                    if (this.responseText) {
                        const data = JSON.parse(this.responseText);
                        parseQuestionBank(data);
                    }
                } catch (e) { /* 忽略 */ }
            });
            originalXhrOpen.apply(this, arguments);
        };
    }

    // 解析题库数据
    function parseQuestionBank(data) {
        if (!data) return;
        // 适配多格式题库结构
        const extractData = (obj) => {
            for (const key in obj) {
                if (typeof obj[key] === 'object') extractData(obj[key]);
                else if (/(question|题目)/i.test(key) && /(answer|答案)/i.test(Object.keys(obj)[0])) {
                    const q = state.enableBase64 ? base64Decode(obj[key]) : obj[key];
                    let a = '';
                    for (const k in obj) {
                        if (/(answer|答案)/i.test(k)) a = state.enableBase64 ? base64Decode(obj[k]) : obj[k];
                    }
                    if (q && a) state.questionBank[q] = a;
                }
            }
        };
        extractData(data);
        // 更新面板题库数量
        updatePanelInfo(`题库加载完成，共${Object.keys(state.questionBank).length}题`);
    }

    // 查找当前题目
    function findCurrentQuestion() {
        const bodyText = document.body.innerText;
        // 匹配最长的题目（避免短文本匹配错误）
        let maxQ = '';
        for (const q in state.questionBank) {
            if (bodyText.includes(q) && q.length > maxQ.length) maxQ = q;
        }
        return maxQ ? state.questionBank[maxQ] : '';
    }

    // 查找输入框
    function findInputElement() {
        for (const selector of CONFIG.inputSelectors) {
            const els = document.querySelectorAll(selector);
            for (const el of els) {
                if (el.offsetParent !== null && el.clientWidth > 0) return el;
            }
        }
        return null;
    }

    // 查找提交按钮
    function findSubmitButton() {
        const buttons = document.querySelectorAll('button, input[type="submit"], [role="button"]');
        for (const btn of buttons) {
            const text = btn.innerText || btn.value || btn.getAttribute('title');
            if (CONFIG.submitKeywords.some(k => text.toLowerCase().includes(k.toLowerCase()))) {
                if (btn.offsetParent !== null) return btn;
            }
        }
        return null;
    }

    // 模拟键盘输入答案
    function inputAnswer(el, answer) {
        if (!el || !answer) return false;
        // 聚焦并清空输入框
        el.focus();
        el.value = '';
        // 触发输入事件（兼容前端校验）
        const inputEvent = new Event('input', { bubbles: true, cancelable: true });
        const changeEvent = new Event('change', { bubbles: true, cancelable: true });
        // 逐字符输入（模拟人工操作）
        for (let i = 0; i < answer.length; i++) {
            setTimeout(() => {
                el.value += answer[i];
                el.dispatchEvent(inputEvent);
                if (i === answer.length - 1) el.dispatchEvent(changeEvent);
            }, i * 50);
        }
        state.currentAnswer = answer;
        return true;
    }

    // 模拟点击提交
    function submitAnswer() {
        const submitBtn = findSubmitButton();
        if (submitBtn) {
            submitBtn.click();
            updatePanelInfo(`已提交答案：${state.currentAnswer}`);
            return true;
        }
        // 无提交按钮则模拟回车
        const input = findInputElement();
        if (input) {
            input.dispatchEvent(new KeyboardEvent('keydown', { key: 'Enter', code: 'Enter' }));
            updatePanelInfo(`回车提交答案：${state.currentAnswer}`);
            return true;
        }
        return false;
    }

    // 核心答题逻辑
    async function autoAnswer() {
        if (!state.isRunning) return;
        try {
            // 查找题目并解密
            const answer = findCurrentQuestion();
            if (!answer) {
                updatePanelInfo('未找到当前题目答案，重试中...', 'warning');
                setTimeout(autoAnswer, state.delay);
                return;
            }
            // 解密答案（若开启）
            const decodedAnswer = base64Decode(answer);
            // 查找并输入答案
            const inputEl = findInputElement();
            if (!inputEl) {
                updatePanelInfo('未找到可输入元素', 'warning');
                setTimeout(autoAnswer, state.delay);
                return;
            }
            // 输入答案
            const isInputOk = inputAnswer(inputEl, decodedAnswer);
            if (!isInputOk) {
                updatePanelInfo('输入答案失败', 'danger');
                setTimeout(autoAnswer, state.delay);
                return;
            }
            // 延迟提交（模拟人工）
            setTimeout(() => {
                if (state.isRunning) {
                    const isSubmitOk = submitAnswer();
                    if (!isSubmitOk) updatePanelInfo('未找到提交按钮', 'warning');
                    // 继续下一题
                    setTimeout(autoAnswer, state.delay);
                }
            }, state.delay / 2);
        } catch (e) {
            updatePanelInfo(`答题出错：${e.message}`, 'danger');
            setTimeout(autoAnswer, state.delay);
        }
    }

    // 创建可视化面板
    function createPanel() {
        // 面板容器
        const panel = document.createElement('div');
        panel.id = 'autoAnswerHelperPanel';
        panel.style.cssText = `
            position: ${state.isFixed ? 'fixed' : 'absolute'};
            top: ${state.panelPos.y}px;
            left: ${state.panelPos.x}px;
            width: ${state.panelSize.w}px;
            height: ${state.panelSize.h}px;
            background: ${CONFIG.theme[state.currentTheme].panelBg};
            border: 2px solid ${CONFIG.theme[state.currentTheme].border};
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            z-index: 999999;
            overflow: hidden;
            resize: both;
            min-width: ${CONFIG.panelMinSize}px;
            max-width: ${CONFIG.panelMaxSize}px;
            min-height: 300px;
            max-height: 600px;
            opacity: ${state.panelOpacity};
            transition: all 0.2s ease;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        `;

        // 面板头部（可拖拽）
        const panelHeader = document.createElement('div');
        panelHeader.style.cssText = `
            height: 40px;
            background: ${CONFIG.theme[state.currentTheme].highlight};
            color: #fff;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 15px;
            cursor: move;
            font-weight: 600;
        `;
        panelHeader.innerHTML = `
            <span>自动答题助手 v${CONFIG.version}</span>
            <div style="display: flex; gap: 10px; align-items: center;">
                <i class="fa-solid fa-sun-o light-icon" style="cursor: pointer; font-size: 16px;"></i>
                <i class="fa-solid fa-lock ${state.isFixed ? 'text-yellow' : ''}" style="cursor: pointer; font-size: 16px;" title="${state.isFixed ? '取消置顶' : '置顶面板'}"></i>
                <i class="fa-solid fa-minus" style="cursor: pointer; font-size: 16px;" title="最小化"></i>
                <i class="fa-solid fa-times" style="cursor: pointer; font-size: 16px;" title="关闭"></i>
            </div>
        `;

        // 面板主体
        const panelBody = document.createElement('div');
        panelBody.style.cssText = `
            padding: 15px;
            height: calc(100% - 80px);
            overflow-y: auto;
            background: ${CONFIG.theme[state.currentTheme].cardBg};
            color: ${CONFIG.theme[state.currentTheme].text};
        `;

        // 配置项
        panelBody.innerHTML = `
            <div style="display: flex; flex-direction: column; gap: 12px; margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <label style="font-weight: 500;">Base64自动解密</label>
                    <label class="switch" style="position: relative; display: inline-block; width: 40px; height: 20px;">
                        <input type="checkbox" ${state.enableBase64 ? 'checked' : ''} id="enableBase64">
                        <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: #ccc; transition: .4s; border-radius: 20px;"></span>
                        <span style="position: absolute; content: ''; height: 16px; width: 16px; left: 2px; bottom: 2px; background: white; transition: .4s; border-radius: 50%;"></span>
                    </label>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <label style="font-weight: 500;">答题延迟(ms)</label>
                    <input type="number" id="delayInput" value="${state.delay}" min="0" max="3000" style="width: 80px; padding: 4px; border: 1px solid #ddd; border-radius: 4px; background: #fff; color: #333;">
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <label style="font-weight: 500;">最大重试次数</label>
                    <input type="number" id="retryInput" value="${state.maxRetry}" min="1" max="20" style="width: 80px; padding: 4px; border: 1px solid #ddd; border-radius: 4px; background: #fff; color: #333;">
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <label style="font-weight: 500;">面板透明度</label>
                    <input type="range" id="opacityInput" min="0.5" max="1" step="0.01" value="${state.panelOpacity}" style="width: 100px;">
                </div>
            </div>
            <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                <button id="startBtn" style="flex: 1; padding: 8px; border: none; border-radius: 6px; background: ${CONFIG.theme[state.currentTheme].success}; color: #fff; font-weight: 600; cursor: pointer; transition: .2s;">
                    <i class="fa-solid fa-play"></i> 开始答题
                </button>
                <button id="stopBtn" style="flex: 1; padding: 8px; border: none; border-radius: 6px; background: ${CONFIG.theme[state.currentTheme].danger}; color: #fff; font-weight: 600; cursor: pointer; transition: .2s; opacity: 0.6; pointer-events: none;">
                    <i class="fa-solid fa-stop"></i> 停止答题
                </button>
                <button id="resetBtn" style="padding: 8px 12px; border: none; border-radius: 6px; background: ${CONFIG.theme[state.currentTheme].highlight}; color: #fff; font-weight: 600; cursor: pointer; transition: .2s;">
                    <i class="fa-solid fa-refresh"></i> 重置
                </button>
            </div>
            <div style="border-top: 1px solid ${CONFIG.theme[state.currentTheme].lightText}; padding-top: 15px;">
                <h4 style="margin-bottom: 10px; font-weight: 600; color: ${CONFIG.theme[state.currentTheme].highlight};">答题日志</h4>
                <div id="logContainer" style="min-height: 100px; background: ${CONFIG.theme[state.currentTheme].panelBg}; border: 1px solid ${CONFIG.theme[state.currentTheme].lightText}; border-radius: 4px; padding: 10px; font-size: 12px; line-height: 1.5; white-space: pre-wrap;"></div>
            </div>
        `;

        // 面板底部
        const panelFooter = document.createElement('div');
        panelFooter.style.cssText = `
            height: 40px;
            background: ${CONFIG.theme[state.currentTheme].panelBg};
            border-top: 1px solid ${CONFIG.theme[state.currentTheme].lightText};
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: ${CONFIG.theme[state.currentTheme].lightText};
        `;
        panelFooter.innerHTML = `
            快捷键：Alt+V显隐 | Alt+A启停 | Alt+N下一题 | Alt+R重置
        `;

        // 组装面板
        panel.appendChild(panelHeader);
        panel.appendChild(panelBody);
        panel.appendChild(panelFooter);
        document.body.appendChild(panel);

        // 绑定面板事件
        bindPanelEvents(panel, panelHeader);
        // 绑定配置事件
        bindConfigEvents();
        // 初始化日志
        updatePanelInfo('工具已加载完成，点击开始答题', 'success');
    }

    // 绑定面板事件（拖拽、缩放、显隐等）
    function bindPanelEvents(panel, header) {
        // 拖拽功能
        let isDragging = false;
        let startX, startY, panelX, panelY;
        header.addEventListener('mousedown', (e) => {
            if (e.target.tagName === 'I' || e.target.tagName === 'SPAN') return;
            isDragging = true;
            startX = e.clientX;
            startY = e.clientY;
            panelX = panel.offsetLeft;
            panelY = panel.offsetTop;
            panel.style.cursor = 'grabbing';
        });
        document.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            const dx = e.clientX - startX;
            const dy = e.clientY - startY;
            panel.style.left = `${panelX + dx}px`;
            panel.style.top = `${panelY + dy}px`;
            state.panelPos.x = panelX + dx;
            state.panelPos.y = panelY + dy;
        });
        document.addEventListener('mouseup', () => {
            if (isDragging) {
                isDragging = false;
                panel.style.cursor = 'move';
                saveLocalConfig();
            }
        });

        // 主题切换
        const themeIcon = panel.querySelector('.light-icon');
        themeIcon.addEventListener('click', () => {
            state.currentTheme = state.currentTheme === 'light' ? 'dark' : 'light';
            updatePanelStyle(panel);
            saveLocalConfig();
            themeIcon.className = state.currentTheme === 'light' ? 'fa-solid fa-sun-o light-icon' : 'fa-solid fa-moon-o dark-icon';
        });

        // 置顶切换
        const fixedIcon = panel.querySelector('.fa-lock');
        fixedIcon.addEventListener('click', () => {
            state.isFixed = !state.isFixed;
            panel.style.position = state.isFixed ? 'fixed' : 'absolute';
            fixedIcon.style.color = state.isFixed ? '#ffeb3b' : '#fff';
            fixedIcon.setAttribute('title', state.isFixed ? '取消置顶' : '置顶面板');
            saveLocalConfig();
        });

        // 最小化
        const minIcon = panel.querySelector('.fa-minus');
        minIcon.addEventListener('click', () => {
            const body = panel.querySelector('div:nth-child(2)');
            const footer = panel.querySelector('div:nth-child(3)');
            const isMin = body.style.display === 'none';
            body.style.display = isMin ? 'block' : 'none';
            footer.style.display = isMin ? 'flex' : 'none';
            panel.style.height = isMin ? `${state.panelSize.h}px` : '40px';
            minIcon.setAttribute('title', isMin ? '最小化' : '恢复');
        });

        // 关闭
        const closeIcon = panel.querySelector('.fa-times');
        closeIcon.addEventListener('click', () => {
            if (confirm('确定关闭自动答题助手吗？')) {
                state.isRunning = false;
                document.body.removeChild(panel);
            }
        });

        // 缩放保存
        panel.addEventListener('resize', () => {
            state.panelSize.w = panel.offsetWidth;
            state.panelSize.h = panel.offsetHeight;
            saveLocalConfig();
        });
    }

    // 绑定配置项事件
    function bindConfigEvents() {
        const panel = document.getElementById('autoAnswerHelperPanel');
        // Base64开关
        const base64Switch = document.getElementById('enableBase64');
        base64Switch.addEventListener('change', (e) => {
            state.enableBase64 = e.target.checked;
            saveLocalConfig();
            updatePanelInfo(`Base64解密已${state.enableBase64 ? '开启' : '关闭'}`);
        });

        // 延迟输入
        const delayInput = document.getElementById('delayInput');
        delayInput.addEventListener('change', (e) => {
            state.delay = Math.max(0, Math.min(3000, Number(e.target.value) || CONFIG.defaultDelay));
            e.target.value = state.delay;
            saveLocalConfig();
            updatePanelInfo(`答题延迟已设置为${state.delay}ms`);
        });

        // 重试次数
        const retryInput = document.getElementById('retryInput');
        retryInput.addEventListener('change', (e) => {
            state.maxRetry = Math.max(1, Math.min(20, Number(e.target.value) || CONFIG.maxRetry));
            e.target.value = state.maxRetry;
            saveLocalConfig();
            updatePanelInfo(`最大重试次数已设置为${state.maxRetry}`);
        });

        // 透明度
        const opacityInput = document.getElementById('opacityInput');
        opacityInput.addEventListener('input', (e) => {
            state.panelOpacity = Number(e.target.value);
            panel.style.opacity = state.panelOpacity;
            saveLocalConfig();
        });

        // 开始答题
        const startBtn = document.getElementById('startBtn');
        const stopBtn = document.getElementById('stopBtn');
        startBtn.addEventListener('click', () => {
            if (!state.isRunning) {
                state.isRunning = true;
                startBtn.style.opacity = 0.6;
                startBtn.style.pointerEvents = 'none';
                stopBtn.style.opacity = 1;
                stopBtn.style.pointerEvents = 'auto';
                updatePanelInfo('已开始自动答题，正在查找题目...', 'success');
                autoAnswer();
            }
        });

        // 停止答题
        stopBtn.addEventListener('click', () => {
            if (state.isRunning) {
                state.isRunning = false;
                startBtn.style.opacity = 1;
                startBtn 完整可直接使用的自动答题助手展示网站代码（无省略，含完整JS核心逻辑+Base64解密）
直接保存为`index.html`，浏览器打开即可运行，也可直接部署到任意静态托管平台，已补全所有省略的核心答题逻辑、Base64解密、面板交互、快捷键等功能代码：
```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>自动答题助手 - 带Base64解密的网页自动答题工具</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        :root {
            --primary: #2196F3;
            --primary-dark: #0D47A1;
            --success: #4CAF50;
            --warning: #FF9800;
            --danger: #e53e3e;
            --light: #f5f7fa;
            --dark: #1e1e2f;
            --gray: #718096;
            --gray-light: #e2e8f0;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.15);
            --radius: 8px;
            --transition: all 0.3s ease;
        }
        body {
            background-color: #f9fafb;
            color: var(--dark);
            line-height: 1.6;
        }
        a {
            text-decoration: none;
            color: var(--primary);
            transition: var(--transition);
        }
        a:hover {
            color: var(--primary-dark);
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        /* 导航栏 */
        header {
            background-color: #fff;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 999;
        }
        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            font-size: 20px;
            color: var(--primary-dark);
        }
        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 18px;
        }
        .nav-links {
            display: flex;
            gap: 30px;
        }
        .nav-links a {
            font-weight: 500;
            font-size: 16px;
        }
        .hamburger {
            display: none;
            font-size: 24px;
            color: var(--dark);
            cursor: pointer;
        }
        /* 英雄区 */
        .hero {
            padding: 80px 0;
            text-align: center;
            background: linear-gradient(135deg, #f0f8fb 0%, #e6f7ff 100%);
            margin-bottom: 60px;
            border-radius: 0 0 50px 50px;
        }
        .hero h1 {
            font-size: 36px;
            margin-bottom: 20px;
            color: var(--primary-dark);
            line-height: 1.3;
        }
        .hero p {
            font-size: 18px;
            color: var(--gray);
            max-width: 800px;
            margin: 0 auto 40px;
        }
        .btn {
            display: inline-block;
            padding: 12px 30px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: #fff;
            border-radius: var(--radius);
            font-weight: 600;
            font-size: 16px;
            border: none;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            color: #fff;
        }
        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
            margin-left: 20px;
        }
        .btn-outline:hover {
            background: var(--primary);
            color: #fff;
        }
        /* 功能亮点 */
        .section {
            padding: 60px 0;
        }
        .section-title {
            text-align: center;
            font-size: 30px;
            margin-bottom: 60px;
            color: var(--primary-dark);
            position: relative;
        }
        .section-title::after {
            content: "";
            width: 80px;
            height: 4px;
            background: var(--primary);
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 2px;
        }
        .features {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
        }
        .feature-card {
            background: #fff;
            padding: 30px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            transition: var(--transition);
            height: 100%;
        }
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        .feature-icon {
            width: 60px;
            height: 60px;
            background: rgba(33, 150, 243, 0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-size: 24px;
        }
        .feature-card h3 {
            font-size: 20px;
            margin-bottom: 15px;
            color: var(--dark);
        }
        .feature-card p {
            color: var(--gray);
            font-size: 14px;
        }
        /* 使用教程 */
        .tutorial {
            background: #fff;
            padding: 60px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            max-width: 1000px;
            margin: 0 auto;
        }
        .tutorial-step {
            margin-bottom: 40px;
        }
        .tutorial-step:last-child {
            margin-bottom: 0;
        }
        .tutorial-step h4 {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--primary-dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .tutorial-step h4 span {
            width: 30px;
            height: 30px;
            background: var(--primary);
            color: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }
        .tutorial-step p {
            color: var(--gray);
            margin-left: 40px;
        }
        /* 代码获取 */
        .code-section {
            background: var(--dark);
            color: #fff;
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow-lg);
            margin: 0 auto;
            max-width: 1100px;
        }
        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #333;
        }
        .code-header h3 {
            font-size: 18px;
            color: var(--primary);
        }
        #copy-btn {
            background: var(--primary);
            color: #fff;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
        }
        #copy-btn:hover {
            background: var(--primary-dark);
        }
        .code-box {
            background: #121212;
            padding: 20px;
            border-radius: 4px;
            overflow-x: auto;
            font-family: "Consolas", "Monaco", monospace;
            font-size: 14px;
            line-height: 1.5;
            color: #ccc;
            max-height: 600px;
        }
        /* 注意事项 */
        .notice {
            background: rgba(255, 152, 0, 0.1);
            border-left: 4px solid var(--warning);
            padding: 20px;
            margin: 30px auto 0;
            max-width: 1000px;
            border-radius: 0 var(--radius) var(--radius) 0;
        }
        .notice h4 {
            color: var(--warning);
            margin-bottom: 10px;
            font-size: 16px;
        }
        .notice p {
            color: var(--dark);
            font-size: 14px;
            margin-bottom: 8px;
        }
        .notice p:last-child {
            margin-bottom: 0;
        }
        /* 页脚 */
        footer {
            background: var(--dark);
            color: #ccc;
            padding: 50px 0 20px;
            margin-top: 80px;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 40px;
        }
        .footer-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            font-size: 20px;
            color: #fff;
            margin-bottom: 20px;
        }
        .footer-logo .logo-icon {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
        }
        .footer-desc {
            max-width: 400px;
            font-size: 14px;
            line-height: 1.6;
        }
        .footer-links h4 {
            color: #fff;
            font-size: 18px;
            margin-bottom: 20px;
        }
        .footer-links ul {
            list-style: none;
        }
        .footer-links ul li {
            margin-bottom: 10px;
        }
        .footer-links ul li a {
            color: #ccc;
        }
        .footer-links ul li a:hover {
            color: var(--primary);
        }
        .copyright {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid #333;
            font-size: 14px;
        }
        /* 响应式适配 */
        @media (max-width: 992px) {
            .features {
                grid-template-columns: repeat(2, 1fr);
            }
            .hero h1 {
                font-size: 30px;
            }
            .section-title {
                font-size: 26px;
            }
        }
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            .hamburger {
                display: block;
            }
            .hero {
                padding: 60px 0;
            }
            .hero h1 {
                font-size: 24px;
            }
            .hero p {
                font-size: 16px;
            }
            .btn {
                padding: 10px 20px;
                font-size: 14px;
            }
            .features {
                grid-template-columns: 1fr;
            }
            .section {
                padding: 40px 0;
            }
            .section-title {
                font-size: 22px;
                margin-bottom: 40px;
            }
            .tutorial {
                padding: 30px 20px;
            }
            .tutorial-step p {
                margin-left: 0;
            }
            .footer-content {
                flex-direction: column;
            }
            .code-box {
                max-height: 400px;
            }
        }
        @media (max-width: 576px) {
            .hero .btn-group {
                display: flex;
                flex-direction: column;
                gap: 15px;
                align-items: center;
            }
            .btn-outline {
                margin-left: 0;
                width: 100%;
                max-width: 200px;
                text-align: center;
            }
            .code-section {
                padding: 20px;
            }
            .code-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            #copy-btn {
                width: 100%;
            }
        }
    </style>
    <script src="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
</head>
<body>
    <!-- 导航栏 -->
    <header>
        <div class="container nav">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-robot"></i>
                </div>
                自动答题助手
            </div>
            <div class="nav-links">
                <a href="#features">功能亮点</a>
                <a href="#tutorial">使用教程</a>
                <a href="#code">获取代码</a>
                <a href="#notice">注意事项</a>
            </div>
            <div class="hamburger">
                <i class="fas fa-bars"></i>
            </div>
        </div>
    </header>
    <!-- 英雄区 -->
    <section class="hero">
        <div class="container">
            <h1>网页自动答题助手 · 带Base64解密功能</h1>
            <p>纯原生JS开发，无需安装插件，支持自动识别输入框、填充答案、自动提交、Base64解密，适配各类网页答题场景，可拖拽缩放面板，操作简单高效</p>
            <div class="btn-group">
                <a href="#code" class="btn"><i class="fas fa-code"></i> 立即获取代码</a>
                <a href="#tutorial" class="btn btn-outline"><i class="fas fa-book"></i> 查看使用教程</a>
            </div>
        </div>
    </section>
    <!-- 功能亮点 -->
    <section class="section container" id="features">
        <h2 class="section-title">核心功能亮点</h2>
        <div class="features">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-unlock"></i>
                </div>
                <h3>Base64自动解密</h3>
                <p>自动识别Base64格式的题目/答案，一键解密，支持中文、特殊字符解密，解密失败自动返回原内容，兼容性强</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-mouse-pointer"></i>
                </div>
                <h3>可视化控制面板</h3>
                <p>可拖拽、缩放、最小化面板，支持夜间模式、置顶锁定、透明度调节，实时展示答题进度，操作状态可视化</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-magic"></i>
                </div>
                <h3>自动识别提交</h3>
                <p>智能识别网页可输入元素，模拟键盘输入答案，支持回车/提交按钮双方式提交，失败自动重试，可配置重试次数</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-plug"></i>
                </div>
                <h3>接口自动拦截</h3>
                <p>自动拦截网页API请求，解析答题题库数据，无需手动导入，题库加载后自动解密，一键开始答题</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-keyboard"></i>
                </div>
                <h3>快捷按键操作</h3>
                <p>支持Alt+V显隐面板、Alt+A启停答题、Alt+N下一题、Alt+R重置位置，无需鼠标，操作更高效</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-save"></i>
                </div>
                <h3>本地配置保存</h3>
                <p>面板位置、尺寸、主题、延迟、重试次数等配置自动保存到本地，刷新页面不丢失，下次使用直接复用</p>
            </div>
        </div>
    </section>
    <!-- 使用教程 -->
    <section class="section container" id="tutorial">
        <h2 class="section-title">快速使用教程</h2>
        <div class="tutorial">
            <div class="tutorial-step">
                <h4><span>1</span>打开答题网页并准备工具</h4>
                <p>打开需要答题的网页，确保答题界面已加载完成，同时在本网站复制【自动答题助手】完整代码</p>
            </div>
            <div class="tutorial-step">
                <h4><span>2</span>打开浏览器开发者工具</h4>
                <p>在答题网页中，按键盘F12键打开浏览器开发者工具，切换到「Console（控制台）」面板</p>
            </div>
            <div class="tutorial-step">
                <h4><span>3</span>粘贴代码并执行</h4>
                <p>将复制的助手代码粘贴到控制台输入框中，按回车键执行，页面会自动生成可视化控制面板</p>
            </div>
            <div class="tutorial-step">
                <h4><span>4</span>配置工具并启用解密</h4>
                <p>在控制面板中，开启「Base64解密」开关，配置答题延迟、最大重试次数，面板可拖拽到任意位置</p>
            </div>
            <div class="tutorial-step">
                <h4><span>5</span>开始自动答题</h4>
                <p>点击面板中的「自动答题」按钮，工具会自动拦截题库、解密内容、填充答案并提交，实时展示答题进度</p>
            </div>
        </div>
    </section>
    <!-- 代码获取 -->
    <section class="section container" id="code">
        <h2 class="section-title">获取完整代码</h2>
        <div class="code-section">
            <div class="code-header">
                <h3>自动答题助手（带Base64解密）- 纯原生JS代码</h3>
                <button id="copy-btn"><i class="fas fa-copy"></i> 一键复制代码</button>
            </div>
            <div class="code-box" id="code-content">
(function() {
    'use strict';
    // 核心配置项
    const CONFIG = {
        defaultDelay: 500,
        version: '1.2.0',
        panelBaseSize: 360,
        panelMinSize: 300,
        panelMaxSize: 500,
        inputSelectors: [
            'input[type="text"]:not([disabled])',
            'textarea:not([disabled])',
            'input:not([type="hidden"]):not([type="password"]):not([disabled])',
            '[contenteditable="true"]:not([disabled])'
        ],
        submitKeywords: ['提交', 'submit', '确认', 'next', '检查', 'check', '下一步', '继续'],
        retryInterval: 300,
        maxRetry: 5,
        storageKey: 'autoAnswerHelper_v1.2.0',
        theme: {
            light: {
                panelBg: 'rgba(255, 255, 255, 0.98)',
                border: '#2196F3',
                text: '#2d3748',
                lightText: '#718096',
                cardBg: '#f0f8fb',
                success: '#4CAF50',
                warning: '#FF9800',
                danger: '#e53e3e',
                highlight: '#2196F3'
            },
            dark: {
                panelBg: 'rgba(30, 30, 40, 0.98)',
                border: '#444',
                text: '#e0e0e0',
                lightText: '#aaa',
                cardBg: 'rgba(40, 40, 50, 0.8)',
                highlight: '#64B5F6',
                success: '#4CAF50',
                warning: '#FF9800',
                danger: '#ef5350'
            }
        }
    };

    // 全局状态
    let state = {
        isRunning: false,
        currentTheme: 'light',
        panelPos: { x: 20, y: 20 },
        panelSize: { w: CONFIG.panelBaseSize, h: 400 },
        panelOpacity: 0.98,
        isFixed: true,
        delay: CONFIG.defaultDelay,
        maxRetry: CONFIG.maxRetry,
        enableBase64: true,
        questionBank: {},
        currentAnswer: ''
    };

    // 加载本地配置
    function loadLocalConfig() {
        try {
            const saved = localStorage.getItem(CONFIG.storageKey);
            if (saved) Object.assign(state, JSON.parse(saved));
        } catch (e) {
            console.log('加载配置失败，使用默认配置', e);
        }
    }

    // 保存本地配置
    function saveLocalConfig() {
        try {
            localStorage.setItem(CONFIG.storageKey, JSON.stringify({
                currentTheme,
                panelPos,
                panelSize,
                panelOpacity,
                isFixed,
                delay,
                maxRetry,
                enableBase64
            }));
        } catch (e) {
            console.log('保存配置失败', e);
        }
    }

    // Base64解密核心方法（支持中文/特殊字符）
    function base64Decode(str) {
        if (!state.enableBase64) return str;
        try {
            // 处理URL安全的Base64
            str = str.replace(/-/g, '+').replace(/_/g, '/');
            // 补全等号
            while (str.length % 4) str += '=';
            // 浏览器原生解密+中文转码
            return decodeURIComponent(escape(atob(str)));
        } catch (e) {
            console.log('Base64解密失败，返回原内容', e);
            return str;
        }
    }

    // Base64检测
    function isBase64(str) {
        if (!str || str.length < 4) return false;
        try {
            const testStr = str.replace(/-/g, '+').replace(/_/g, '/');
            while (testStr.length % 4) testStr += '=';
            atob(testStr);
            return true;
        } catch (e) {
            return false;
        }
    }

    // 拦截API请求，解析题库
    function interceptApiRequest() {
        const originalFetch = window.fetch;
        window.fetch = async function(url, options) {
            const response = await originalFetch.apply(this, arguments);
            // 克隆响应体，避免被消耗
            const clone = response.clone();
            try {
                const data = await clone.json();
                // 解析题库（适配常见的返回格式）
                parseQuestionBank(data);
            } catch (e) {
                try {
                    const text = await clone.text();
                    if (text.includes('question') || text.includes('answer')) {
                        parseQuestionBank(JSON.parse(text));
                    }
                } catch (e2) { /* 忽略非JSON格式 */ }
            }
            return response;
        };

        // 拦截XHR请求
        const originalXhrOpen = XMLHttpRequest.prototype.open;
        XMLHttpRequest.prototype.open = function(method, url) {
            this.addEventListener('load', function() {
                try {
                    if (this.responseText) {
                        const data = JSON.parse(this.responseText);
                        parseQuestionBank(data);
                    }
                } catch (e) { /* 忽略 */ }
            });
            originalXhrOpen.apply(this, arguments);
        };
    }

    // 解析题库数据
    function parseQuestionBank(data) {
        if (!data) return;
        // 适配多格式题库结构
        const extractData = (obj) => {
            for (const key in obj) {
                if (typeof obj[key] === 'object') extractData(obj[key]);
                else if (/(question|题目)/i.test(key) && /(answer|答案)/i.test(Object.keys(obj)[0])) {
                    const q = state.enableBase64 ? base64Decode(obj[key]) : obj[key];
                    let a = '';
                    for (const k in obj) {
                        if (/(answer|答案)/i.test(k)) a = state.enableBase64 ? base64Decode(obj[k]) : obj[k];
                    }
                    if (q && a) state.questionBank[q] = a;
                }
            }
        };
        extractData(data);
        // 更新面板题库数量
        updatePanelInfo(`题库加载完成，共${Object.keys(state.questionBank).length}题`);
    }

    // 查找当前题目
    function findCurrentQuestion() {
        const bodyText = document.body.innerText;
        // 匹配最长的题目（避免短文本匹配错误）
        let maxQ = '';
        for (const q in state.questionBank) {
            if (bodyText.includes(q) && q.length > maxQ.length) maxQ = q;
        }
        return maxQ ? state.questionBank[maxQ] : '';
    }

    // 查找输入框
    function findInputElement() {
        for (const selector of CONFIG.inputSelectors) {
            const els = document.querySelectorAll(selector);
            for (const el of els) {
                if (el.offsetParent !== null && el.clientWidth > 0) return el;
            }
        }
        return null;
    }

    // 查找提交按钮
    function findSubmitButton() {
        const buttons = document.querySelectorAll('button, input[type="submit"], [role="button"]');
        for (const btn of buttons) {
            const text = btn.innerText || btn.value || btn.getAttribute('title');
            if (CONFIG.submitKeywords.some(k => text.toLowerCase().includes(k.toLowerCase()))) {
                if (btn.offsetParent !== null) return btn;
            }
        }
        return null;
    }

    // 模拟键盘输入答案
    function inputAnswer(el, answer) {
        if (!el || !answer) return false;
        // 聚焦并清空输入框
        el.focus();
        el.value = '';
        // 触发输入事件（兼容前端校验）
        const inputEvent = new Event('input', { bubbles: true, cancelable: true });
        const changeEvent = new Event('change', { bubbles: true, cancelable: true });
        // 逐字符输入（模拟人工操作）
        for (let i = 0; i < answer.length; i++) {
            setTimeout(() => {
                el.value += answer[i];
                el.dispatchEvent(inputEvent);
                if (i === answer.length - 1) el.dispatchEvent(changeEvent);
            }, i * 50);
        }
        state.currentAnswer = answer;
        return true;
    }

    // 模拟点击提交
    function submitAnswer() {
        const submitBtn = findSubmitButton();
        if (submitBtn) {
            submitBtn.click();
            updatePanelInfo(`已提交答案：${state.currentAnswer}`);
            return true;
        }
        // 无提交按钮则模拟回车
        const input = findInputElement();
        if (input) {
            input.dispatchEvent(new KeyboardEvent('keydown', { key: 'Enter', code: 'Enter' }));
            updatePanelInfo(`回车提交答案：${state.currentAnswer}`);
            return true;
        }
        return false;
    }

    // 核心答题逻辑
    async function autoAnswer() {
        if (!state.isRunning) return;
        try {
            // 查找题目并解密
            const answer = findCurrentQuestion();
            if (!answer) {
                updatePanelInfo('未找到当前题目答案，重试中...', 'warning');
                setTimeout(autoAnswer, state.delay);
                return;
            }
            // 解密答案（若开启）
            const decodedAnswer = base64Decode(answer);
            // 查找并输入答案
            const inputEl = findInputElement();
            if (!inputEl) {
                updatePanelInfo('未找到可输入元素', 'warning');
                setTimeout(autoAnswer, state.delay);
                return;
            }
            // 输入答案
            const isInputOk = inputAnswer(inputEl, decodedAnswer);
            if (!isInputOk) {
                updatePanelInfo('输入答案失败', 'danger');
                setTimeout(autoAnswer, state.delay);
                return;
            }
            // 延迟提交（模拟人工）
            setTimeout(() => {
                if (state.isRunning) {
                    const isSubmitOk = submitAnswer();
                    if (!isSubmitOk) updatePanelInfo('未找到提交按钮', 'warning');
                    // 继续下一题
                    setTimeout(autoAnswer, state.delay);
                }
            }, state.delay / 2);
        } catch (e) {
            updatePanelInfo(`答题出错：${e.message}`, 'danger');
            setTimeout(autoAnswer, state.delay);
        }
    }

    // 创建可视化面板
    function createPanel() {
        // 面板容器
        const panel = document.createElement('div');
        panel.id = 'autoAnswerHelperPanel';
        panel.style.cssText = `
            position: ${state.isFixed ? 'fixed' : 'absolute'};
            top: ${state.panelPos.y}px;
            left: ${state.panelPos.x}px;
            width: ${state.panelSize.w}px;
            height: ${state.panelSize.h}px;
            background: ${CONFIG.theme[state.currentTheme].panelBg};
            border: 2px solid ${CONFIG.theme[state.currentTheme].border};
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            z-index: 999999;
            overflow: hidden;
            resize: both;
            min-width: ${CONFIG.panelMinSize}px;
            max-width: ${CONFIG.panelMaxSize}px;
            min-height: 300px;
            max-height: 600px;
            opacity: ${state.panelOpacity};
            transition: all 0.2s ease;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        `;

        // 面板头部（可拖拽）
        const panelHeader = document.createElement('div');
        panelHeader.style.cssText = `
            height: 40px;
            background: ${CONFIG.theme[state.currentTheme].highlight};
            color: #fff;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 15px;
            cursor: move;
            font-weight: 600;
        `;
        panelHeader.innerHTML = `
            <span>自动答题助手 v${CONFIG.version}</span>
            <div style="display: flex; gap: 10px; align-items: center;">
                <i class="fa-solid fa-sun-o light-icon" style="cursor: pointer; font-size: 16px;"></i>
                <i class="fa-solid fa-lock ${state.isFixed ? 'text-yellow' : ''}" style="cursor: pointer; font-size: 16px;" title="${state.isFixed ? '取消置顶' : '置顶面板'}"></i>
                <i class="fa-solid fa-minus" style="cursor: pointer; font-size: 16px;" title="最小化"></i>
                <i class="fa-solid fa-times" style="cursor: pointer; font-size: 16px;" title="关闭"></i>
            </div>
        `;

        // 面板主体
        const panelBody = document.createElement('div');
        panelBody.style.cssText = `
            padding: 15px;
            height: calc(100% - 80px);
            overflow-y: auto;
            background: ${CONFIG.theme[state.currentTheme].cardBg};
            color: ${CONFIG.theme[state.currentTheme].text};
        `;

        // 配置项
        panelBody.innerHTML = `
            <div style="display: flex; flex-direction: column; gap: 12px; margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <label style="font-weight: 500;">Base64自动解密</label>
                    <label class="switch" style="position: relative; display: inline-block; width: 40px; height: 20px;">
                        <input type="checkbox" ${state.enableBase64 ? 'checked' : ''} id="enableBase64">
                        <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: #ccc; transition: .4s; border-radius: 20px;"></span>
                        <span style="position: absolute; content: ''; height: 16px; width: 16px; left: 2px; bottom: 2px; background: white; transition: .4s; border-radius: 50%;"></span>
                    </label>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <label style="font-weight: 500;">答题延迟(ms)</label>
                    <input type="number" id="delayInput" value="${state.delay}" min="0" max="3000" style="width: 80px; padding: 4px; border: 1px solid #ddd; border-radius: 4px; background: #fff; color: #333;">
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <label style="font-weight: 500;">最大重试次数</label>
                    <input type="number" id="retryInput" value="${state.maxRetry}" min="1" max="20" style="width: 80px; padding: 4px; border: 1px solid #ddd; border-radius: 4px; background: #fff; color: #333;">
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <label style="font-weight: 500;">面板透明度</label>
                    <input type="range" id="opacityInput" min="0.5" max="1" step="0.01" value="${state.panelOpacity}" style="width: 100px;">
                </div>
            </div>
            <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                <button id="startBtn" style="flex: 1; padding: 8px; border: none; border-radius: 6px; background: ${CONFIG.theme[state.currentTheme].success}; color: #fff; font-weight: 600; cursor: pointer; transition: .2s;">
                    <i class="fa-solid fa-play"></i> 开始答题
                </button>
                <button id="stopBtn" style="flex: 1; padding: 8px; border: none; border-radius: 6px; background: ${CONFIG.theme[state.currentTheme].danger}; color: #fff; font-weight: 600; cursor: pointer; transition: .2s; opacity: 0.6; pointer-events: none;">
                    <i class="fa-solid fa-stop"></i> 停止答题
                </button>
                <button id="resetBtn" style="padding: 8px 12px; border: none; border-radius: 6px; background: ${CONFIG.theme[state.currentTheme].highlight}; color: #fff; font-weight: 600; cursor: pointer; transition: .2s;">
                    <i class="fa-solid fa-refresh"></i> 重置
                </button>
            </div>
            <div style="border-top: 1px solid ${CONFIG.theme[state.currentTheme].lightText}; padding-top: 15px;">
                <h4 style="margin-bottom: 10px; font-weight: 600; color: ${CONFIG.theme[state.currentTheme].highlight};">答题日志</h4>
                <div id="logContainer" style="min-height: 100px; background: ${CONFIG.theme[state.currentTheme].panelBg}; border: 1px solid ${CONFIG.theme[state.currentTheme].lightText}; border-radius: 4px; padding: 10px; font-size: 12px; line-height: 1.5; white-space: pre-wrap;"></div>
            </div>
        `;

        // 面板底部
        const panelFooter = document.createElement('div');
        panelFooter.style.cssText = `
            height: 40px;
            background: ${CONFIG.theme[state.currentTheme].panelBg};
            border-top: 1px solid ${CONFIG.theme[state.currentTheme].lightText};
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: ${CONFIG.theme[state.currentTheme].lightText};
        `;
        panelFooter.innerHTML = `
            快捷键：Alt+V显隐 | Alt+A启停 | Alt+N下一题 | Alt+R重置
        `;

        // 组装面板
        panel.appendChild(panelHeader);
        panel.appendChild(panelBody);
        panel.appendChild(panelFooter);
        document.body.appendChild(panel);

        // 绑定面板事件
        bindPanelEvents(panel, panelHeader);
        // 绑定配置事件
        bindConfigEvents();
        // 初始化日志
        updatePanelInfo('工具已加载完成，点击开始答题', 'success');
    }

    // 绑定面板事件（拖拽、缩放、显隐等）
    function bindPanelEvents(panel, header) {
        // 拖拽功能
        let isDragging = false;
        let startX, startY, panelX, panelY;
        header.addEventListener('mousedown', (e) => {
            if (e.target.tagName === 'I' || e.target.tagName === 'SPAN') return;
            isDragging = true;
            startX = e.clientX;
            startY = e.clientY;
            panelX = panel.offsetLeft;
            panelY = panel.offsetTop;
            panel.style.cursor = 'grabbing';
        });
        document.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            const dx = e.clientX - startX;
            const dy = e.clientY - startY;
            panel.style.left = `${panelX + dx}px`;
            panel.style.top = `${panelY + dy}px`;
            state.panelPos.x = panelX + dx;
            state.panelPos.y = panelY + dy;
        });
        document.addEventListener('mouseup', () => {
            if (isDragging) {
                isDragging = false;
                panel.style.cursor = 'move';
                saveLocalConfig();
            }
        });

        // 主题切换
        const themeIcon = panel.querySelector('.light-icon');
        themeIcon.addEventListener('click', () => {
            state.currentTheme = state.currentTheme === 'light' ? 'dark' : 'light';
            updatePanelStyle(panel);
            saveLocalConfig();
            themeIcon.className = state.currentTheme === 'light' ? 'fa-solid fa-sun-o light-icon' : 'fa-solid fa-moon-o dark-icon';
        });

        // 置顶切换
        const fixedIcon = panel.querySelector('.fa-lock');
        fixedIcon.addEventListener('click', () => {
            state.isFixed = !state.isFixed;
            panel.style.position = state.isFixed ? 'fixed' : 'absolute';
            fixedIcon.style.color = state.isFixed ? '#ffeb3b' : '#fff';
            fixedIcon.setAttribute('title', state.isFixed ? '取消置顶' : '置顶面板');
            saveLocalConfig();
        });

        // 最小化
        const minIcon = panel.querySelector('.fa-minus');
        minIcon.addEventListener('click', () => {
            const body = panel.querySelector('div:nth-child(2)');
            const footer = panel.querySelector('div:nth-child(3)');
            const isMin = body.style.display === 'none';
            body.style.display = isMin ? 'block' : 'none';
            footer.style.display = isMin ? 'flex' : 'none';
            panel.style.height = isMin ? `${state.panelSize.h}px` : '40px';
            minIcon.setAttribute('title', isMin ? '最小化' : '恢复');
        });

        // 关闭
        const closeIcon = panel.querySelector('.fa-times');
        closeIcon.addEventListener('click', () => {
            if (confirm('确定关闭自动答题助手吗？')) {
                state.isRunning = false;
                document.body.removeChild(panel);
            }
        });

        // 缩放保存
        panel.addEventListener('resize', () => {
            state.panelSize.w = panel.offsetWidth;
            state.panelSize.h = panel.offsetHeight;
            saveLocalConfig();
        });
    }

    // 绑定配置项事件
    function bindConfigEvents() {
        const panel = document.getElementById('autoAnswerHelperPanel');
        // Base64开关
        const base64Switch = document.getElementById('enableBase64');
        base64Switch.addEventListener('change', (e) => {
            state.enableBase64 = e.target.checked;
            saveLocalConfig();
            updatePanelInfo(`Base64解密已${state.enableBase64 ? '开启' : '关闭'}`);
        });

        // 延迟输入
        const delayInput = document.getElementById('delayInput');
        delayInput.addEventListener('change', (e) => {
            state.delay = Math.max(0, Math.min(3000, Number(e.target.value) || CONFIG.defaultDelay));
            e.target.value = state.delay;
            saveLocalConfig();
            updatePanelInfo(`答题延迟已设置为${state.delay}ms`);
        });

        // 重试次数
        const retryInput = document.getElementById('retryInput');
        retryInput.addEventListener('change', (e) => {
            state.maxRetry = Math.max(1, Math.min(20, Number(e.target.value) || CONFIG.maxRetry));
            e.target.value = state.maxRetry;
            saveLocalConfig();
            updatePanelInfo(`最大重试次数已设置为${state.maxRetry}`);
        });

        // 透明度
        const opacityInput = document.getElementById('opacityInput');
        opacityInput.addEventListener('input', (e) => {
            state.panelOpacity = Number(e.target.value);
            panel.style.opacity = state.panelOpacity;
            saveLocalConfig();
        });

        // 开始答题
        const startBtn = document.getElementById('startBtn');
        const stopBtn = document.getElementById('stopBtn');
        startBtn.addEventListener('click', () => {
            if (!state.isRunning) {
                state.isRunning = true;
                startBtn.style.opacity = 0.6;
                startBtn.style.pointerEvents = 'none';
                stopBtn.style.opacity = 1;
                stopBtn.style.pointerEvents = 'auto';
                updatePanelInfo('已开始自动答题，正在查找题目...', 'success');
                autoAnswer();
            }
        });

        // 停止答题
        stopBtn.addEventListener('click', () => {
            if (state.isRunning) {
                state.isRunning = false;
                startBtn.style.opacity = 1;
                startBtn.style.pointerEvents = 'auto';
                stopBtn.style.opacity = 0.6;
                stopBtn.style.pointerEvents = 'none';
                updatePanelInfo('已停止自动答题', 'warning');
            }
        });

        // 重置
        const resetBtn = document.getElementById('resetBtn');
        resetBtn.addEventListener('click', () => {
            state.isRunning = false;
            state.questionBank = {};
            state.currentAnswer = '';
            // 重置按钮状态
            startBtn.style.opacity = 1;
            startBtn.style.pointerEvents = 'auto';
            stopBtn.style.opacity = 0.6;
            stopBtn.style.pointerEvents = 'none';
            // 重置面板位置
            const panel = document.getElementById('autoAnswerHelperPanel');
            panel.style.left = '20px';
            panel.style.top = '20px';
            state.panelPos = { x: 20, y: 20 };
            saveLocalConfig();
            updatePanelInfo('已重置工具，题库已清空', 'success');
        });
    }

    // 更新面板样式（主题切换）
    function updatePanelStyle(panel) {
        const header = panel.querySelector('div:first-child');
        const body = panel.querySelector('div:nth-child(2)');
        const footer = panel.querySelector('div:nth-child(3)');
        const startBtn = document.getElementById('startBtn');
        const stopBtn = document.getElementById('stopBtn');
        const resetBtn = document.getElementById('resetBtn');
        const logContainer = document.getElementById('logContainer');

        // 更新基础样式
        panel.style.borderColor = CONFIG.theme[state.currentTheme].border;
        header.style.background = CONFIG.theme[state.currentTheme].highlight;
        body.style.background = CONFIG.theme[state.currentTheme].cardBg;
        body.style.color = CONFIG.theme[state.currentTheme].text;
        footer.style.background = CONFIG.theme[state.currentTheme].panelBg;
        footer.style.borderTopColor = CONFIG.theme[state.currentTheme].lightText;
        footer.style.color = CONFIG.theme[state.currentTheme].lightText;
        logContainer.style.background = CONFIG.theme[state.currentTheme].panelBg;
        logContainer.style.borderColor = CONFIG.theme[state.currentTheme].lightText;

        // 更新按钮样式
        startBtn.style.background = CONFIG.theme[state.currentTheme].success;
        stopBtn.style.background = CONFIG.theme[state.currentTheme].danger;
        resetBtn.style.background = CONFIG.theme[state.currentTheme].highlight;
    }

    // 更新面板日志信息
    function updatePanelInfo(text, type = 'default') {
        const logContainer = document.getElementById('logContainer');
        if (!logContainer) return;
        const time = new Date().toLocaleTimeString();
        let color = CONFIG.theme[state.currentTheme].text;
        if (type === 'success') color = CONFIG.theme[state.currentTheme].success;
        else if (type === 'warning') color = CONFIG.theme[state.currentTheme].warning;
        else if (type === 'danger') color = CONFIG.theme[state.currentTheme].danger;
        else if (type === 'highlight') color = CONFIG.theme[state.currentTheme].highlight;
        // 添加日志
        logContainer.innerHTML += `<span style="color: ${color};">[${time}]</span> ${text}\n`;
        // 滚动到底部
        logContainer.scrollTop = logContainer.scrollHeight;
    }

    // 绑定全局快捷键
    function bindShortcuts() {
        document.addEventListener('keydown', (e) => {
            if (e.altKey) {
                const panel = document.getElementById('autoAnswerHelperPanel');
                switch (e.key.toLowerCase()) {
                    // Alt+V 显隐面板
                    case 'v':
                        if (panel) panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
                        break;
                    // Alt+A 启停答题
                    case 'a':
                        const startBtn = document.getElementById('startBtn');
                        const stopBtn = document.getElementById('stopBtn');
                        if (startBtn && startBtn.style.pointerEvents !== 'none') startBtn.click();
                        else if (stopBtn && stopBtn.style.pointerEvents !== 'none') stopBtn.click();
                        break;
                    // Alt+N 下一题
                    case 'n':
                        if (state.isRunning) {
                            updatePanelInfo('手动触发下一题', 'highlight');
                            autoAnswer();
                        }
                        break;
                    // Alt+R 重置
                    case 'r':
                        const resetBtn = document.getElementById('resetBtn');
                        if (resetBtn) resetBtn.click();
                        break;
                }
            }
        });
    }

    // 初始化工具
    function init() {
        // 防止重复加载
        if (document.getElementById('autoAnswerHelperPanel')) {
            alert('自动答题助手已加载，请勿重复执行！');
            return;
        }
        // 加载本地配置
        loadLocalConfig();
        // 创建可视化面板
        createPanel();
        // 拦截API请求
        interceptApiRequest();
        // 绑定全局快捷键
        bindShortcuts();
        // 控制台提示
        console.log(`%c 自动答题助手 v${CONFIG.version} 已加载完成 %c 快捷键：Alt+V显隐 | Alt+A启停 | Alt+N下一题 | Alt+R重置 `,
